# ============================================================================
# Netlify Configuration for Wedding App (Next.js + Clerk)
# ============================================================================

[build]
  command = "npm run build"
  publish = ".next"

[build.environment]
  NODE_OPTIONS = "--dns-result-order=ipv4first --max-old-space-size=2048"
  NODE_MEMORY_AVAILABLE = "2048"
  SECRETS_SCAN_SMART_DETECTION_ENABLED = "false"
  AWS_NODEJS_CONNECTION_REUSE_ENABLED = "1"

# ============================================================================
# PLUGINS
# ============================================================================

[[plugins]]
  package = "netlify-plugin-cache-nextjs"

[[plugins]]
  package = "@netlify/plugin-nextjs"

# ============================================================================
# SERVERLESS FUNCTIONS CONFIGURATION
# ============================================================================

[functions]
  node_bundler = "esbuild"
  included_files = ["src/**"]
  external_node_modules = ["@clerk/nextjs"]

# ============================================================================
# NOTES
# ============================================================================
# 1. Set environment variables in Netlify UI: Site settings â†’ Environment
#    - NEXT_PUBLIC_CLERK_PUBLISHABLE_KEY
#    - CLERK_SECRET_KEY
#    - MONGODB_URI (MongoDB connection string)
#    - MONGODB_DB (optional, defaults to 'wedding-app')
# 2. Build time: Usually 1-3 minutes
# 3. If build fails, try: Clear cache and redeploy in Netlify UI
# ============================================================================
